# App configuration
general:
  lang: pt_BR
  instanceId: instance1
  suffix: dc=example,dc=org
  adminPassword: admin

sourceParameters:
- type: sql
  dbUsername: dbuser
  dbPassword: userpass
  dbServer: dev.local
  dbPort: 3306

sources:
#- id: ldap1
#  type: proxy
#  suffix: dc=ldap,dc=example,dc=org
#  targetURI: "ldap://dev.local:10389"
#  aclBind: binddn="cn=admin,dc=test,dc=com" credentials="admin"
- id: sql_users
  enabled: true
  suffix: ou=users,dc=example,dc=org
  sourceJdbcURL: "jdbc:mariadb://dev.local:3306/source"
  sourceUsername: "dbuser"
  sourcePassword: "userpass"
  dnFormat: uid=%s
  type: sql
  query: select username, concat(name, ' ', surname) as full_name, name, surname, phone, email from users
  idColumn: username
  attributes:
  - givenName=name
  - sn=surname
  - cn=username
  - telephoneNumber=phone
  - mail=email
  joinData:
  - id: data1
    query: >- 
        select a.groupname , a.username
        from groups a 
        inner join users b
        on a.username = b.username
    joinColumns: username=username
    attributes:
    - memberOf=groupname
    idColumn: username
  objectClasses: 
  - inetOrgPerson
- id: sql_groups
  enabled: true
  suffix: ou=groups,dc=example,dc=org
  dnFormat: cn=%s
  type: sql
  sourceJdbcURL: "jdbc:mariadb://dev.local:3306/source"
  sourceUsername: "dbuser"
  sourcePassword: "userpass"
  query: select groupname from groups
  idColumn: groupname
  attributes:
  - cn=groupname
  joinData:
  - id: data2
    query: >- 
        select distinct a.groupname, a.username
        from groups a 
    joinColumns: groupname
    idColumn: username 
    attributes:
    - member=username
  objectClasses: 
  - groupOfNames
  